// @ts-nocheck
!function(){const e={characterFiles:["Abigail_Beach.png","Abigail_Winter.png","Abigail.png","Alex_Beach.png","Alex_Winter.png","Alex.png","Birdie.png","Caroline_Beach.png","Caroline_Winter.png","Caroline.png","Clint_Beach.png","Clint_Winter.png","Clint.png","Demetrius_Winter.png","Demetrius.png","Elliott_Beach.png","Elliott_Winter.png","Elliott.png","Emily_Beach.png","Emily_Winter.png","Emily.png","Evelyn_Winter.png","Evelyn.png","George_Winter.png","George.png","Gus_Winter.png","Gus.png","Haley_Beach.png","Haley_Winter.png","Haley.png","Harvey_Beach.png","Harvey_Winter.png","Harvey.png","Jas_Winter.png","Jas.png","Jodi_Beach.png","Jodi_Winter.png","Jodi.png","Kent_Winter.png","Kent.png","Leah_Beach.png","Leah_Winter.png","Leah.png","Lewis_Beach.png","Lewis_Winter.png","Lewis.png","Linus_Winter.png","Linus.png","Marcello.png","Marnie_Beach.png","Marnie_Winter.png","Marnie.png","Maru_Beach.png","Maru_Hospital.png","Maru_Winter.png","Maru.png","Morris.png","Pam_Beach.png","Pam_Winter.png","Pam.png","ParrotBoy_Winter.png","ParrotBoy.png","Penny_Beach.png","Penny_Winter.png","Penny.png","Pierre_Beach.png","Pierre_Winter.png","Pierre.png","Robin_Beach.png","Robin_Winter.png","Robin.png","SafariGuy.png","Sam_Beach.png","Sam_JojaMart.png","Sam_Winter.png","Sam.png","Sandy.png","Sebastian_Beach.png","Sebastian_Winter.png","Sebastian.png","Shane_Beach.png","Shane_JojaMart.png","Shane_Winter.png","Shane.png","Vincent_Winter.png","Vincent.png","Willy_Winter.png","Willy.png","Wizard.png"],animationFiles:["Abigail_Beach.json","Abigail_Winter.json","Abigail.json","Alex_Beach.json","Alex_Winter.json","Alex.json","Birdie.json","Caroline_Beach.json","Caroline_Winter.json","Caroline.json","Clint_Beach.json","Clint_Winter.json","Clint.json","Demetrius_Winter.json","Demetrius.json","Elliott_Beach.json","Elliott_Winter.json","Elliott.json","Emily_Beach.json","Emily_Winter.json","Emily.json","Evelyn_Winter.json","Evelyn.json","George_Winter.json","George.json","Gus_Winter.json","Gus.json","Haley_Beach.json","Haley_Winter.json","Haley.json","Harvey_Beach.json","Harvey_Winter.json","Harvey.json","Jas_Winter.json","Jas.json","Jodi_Beach.json","Jodi_Winter.json","Jodi.json","Kent_Winter.json","Kent.json","Leah_Beach.json","Leah_Winter.json","Leah.json","Lewis_Beach.json","Lewis_Winter.json","Lewis.json","Linus_Winter.json","Linus.json","Marcello.json","Marnie_Beach.json","Marnie_Winter.json","Marnie.json","Maru_Beach.json","Maru_Hospital.json","Maru_Winter.json","Maru.json","Morris.json","Pam_Beach.json","Pam_Winter.json","Pam.json","ParrotBoy_Winter.json","ParrotBoy.json","Penny_Beach.json","Penny_Winter.json","Penny.json","Pierre_Beach.json","Pierre_Winter.json","Pierre.json","Robin_Beach.json","Robin_Winter.json","Robin.json","SafariGuy.json","Sam_Beach.json","Sam_JojaMart.json","Sam_Winter.json","Sam.json","Sandy.json","Sebastian_Beach.json","Sebastian_Winter.json","Sebastian.json","Shane_Beach.json","Shane_JojaMart.json","Shane_Winter.json","Shane.json","Vincent_Winter.json","Vincent.json","Willy_Winter.json","Willy.json","Wizard.json"],variantTypes:[{value:"Beach",label:"海滩"},{value:"Winter",label:"冬季"},{value:"JojaMart",label:"Joja超市"},{value:"Hospital",label:"医院"}]};function n(e,...n){try{return"function"==typeof e&&"AsyncFunction"!==e.constructor.name?e(...n):null}catch(n){return console.log(`${e.name} 执行失败: ${n}`),null}}var a;async function t(e,n){try{n.innerHTML="";const a=await async function(e){try{const n=await fetch(`https://wiki.biligame.com/stardewvalley/%E6%95%B0%E6%8D%AE:Animation/${e}.json?action=raw&ctype=application/json`);if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);return function(e){const n=e.replace(/,(\s*[\}\]])/g,"$1");return JSON.parse(n)}(await n.text())}catch(n){throw console.error(`加载 ${e} 的动画配置失败:`,n),n}}(e),t=await async function(e){return new Promise(((n,a)=>{const t=new Image;t.src=`https://wiki.biligame.com/stardewvalley/Special:Redirect/file/Animation_${e}.png`,t.onload=()=>n(t),t.onerror=()=>a(new Error(`加载精灵图 ${e}.png 失败`))}))}(e);!function(e,n,a,t){if(!n||0===n.length)return void(t.innerHTML=`<div class="stardew-embed-error">没有找到 ${e} 的动画。</div>`);const i=16,r=32,s=4;n.forEach((n=>{const o=document.createElement("div");o.className="stardew-embed-animation";const l=document.createElement("div");l.className="stardew-embed-animation-title",l.textContent=n.animation.replace("lauphing","laughing");const c=document.createElement("div");c.className="stardew-embed-sprite-container";const d=document.createElement("div");d.className="stardew-embed-sprite",d.style.width=`${a.width}px`,d.style.height=`${a.height}px`,d.style.backgroundImage=`url(https://wiki.biligame.com/stardewvalley/Special:Redirect/file/Animation_${e}.png)`,c.appendChild(d),o.appendChild(l),o.appendChild(c),t.appendChild(o),o.title=n.animation.replace("lauphing","laughing"),function(e,n,a,t,i){let r,s=0;e.dataset.intervalId&&clearInterval(parseInt(e.dataset.intervalId));r=setInterval((()=>{const r=n[s],o=Math.floor(r/i),l=r%i;e.style.backgroundPosition=`-${l*a}px -${o*t}px`,s=(s+1)%n.length}),200),e.dataset.intervalId=r}(d,n.frames,i,r,s)}))}(e,a,t,n)}catch(e){console.error(`加载动画失败: ${e.message}`),n.innerHTML=`<div class="stardew-embed-error">加载动画失败: ${e.message}</div>`}}a=()=>{const n=document.querySelectorAll("#stardew-character-player, [data-stardew-character]");0!==n.length?n.forEach((n=>{!function(n){const a=n.dataset.character||n.dataset.stardewCharacter;a?(console.log(`初始化角色播放器: ${a}`),function(e){e.classList.add("stardew-embed"),e.innerHTML='\n            <div class="stardew-embed-container">\n                <div class="stardew-embed-sidebar">\n                    <div class="stardew-embed-variants">\n                        <div class="stardew-embed-variant-item active" data-variant="">默认</div>\n                    </div>\n                </div>\n                <div class="stardew-embed-content">\n                    <div class="stardew-embed-loading">加载中...</div>\n                    <div class="stardew-embed-animations">\n                    </div>\n                </div>\n            </div>\n        '}(n),async function(n,a){a.querySelector(".stardew-embed-sidebar");const i=a.querySelector(".stardew-embed-variants"),r=(a.querySelector(".stardew-embed-content"),a.querySelector(".stardew-embed-loading")),s=a.querySelector(".stardew-embed-animations");r.style.display="block",s.style.display="none";try{const a=await async function(n){const a=[];for(const t of e.variantTypes){const i=`${n}_${t.value}.json`;e.animationFiles.includes(i)&&a.push(t)}return a}(n);if(a.length>0){for(;i.children.length>1;)i.removeChild(i.lastChild);a.forEach((e=>{const a=document.createElement("div");a.className="stardew-embed-variant-item",a.dataset.variant=e.value,a.textContent=e.label,i.appendChild(a),a.addEventListener("click",(async()=>{i.querySelectorAll(".stardew-embed-variant-item").forEach((e=>{e.classList.remove("active")})),a.classList.add("active"),r.style.display="block",s.style.display="none";const o=e.value?`${n}_${e.value}`:`${n}`;await t(o,s),r.style.display="none",s.style.display="flex"}))}))}const o=i.querySelector('.stardew-embed-variant-item[data-variant=""]');o&&o.addEventListener("click",(async()=>{i.querySelectorAll(".stardew-embed-variant-item").forEach((e=>{e.classList.remove("active")})),o.classList.add("active"),r.style.display="block",s.style.display="none",await t(n,s),r.style.display="none",s.style.display="flex"})),await t(n,s)}catch(e){console.error(`加载角色数据失败: ${e.message}`),s.innerHTML=`<div class="stardew-embed-error">加载角色 ${n} 失败: ${e.message}</div>`}finally{r.style.display="none",s.style.display="flex"}}(a,n)):n.innerHTML='<div class="stardew-embed-error">未指定角色名称</div>'}(n)})):console.warn("未找到Stardew Valley角色播放器容器")},n((()=>{const e=()=>n(a);"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}))}();